name: swagger-ui
kind: pipeline
type: kubernetes

steps:
- name: prebuild
  image: harbor.adamkoro.com/bci/bci-base:latest
  commands:
  - echo "{\"auths\":{\"harbor.adamkoro.com\":{\"auth\":\"$(echo "${registry_username}:${registry_password}" | base64)\"}}}" > /kaniko/.docker/config.json
  volumes:
  - name: kaniko-auth
    path: /kaniko/.docker

- name: build
  image: plugins/kaniko:1.7.1
  settings:
    #username:
    #  from_secret: registry_username
    #password:
    #  from_secret: registry_password
    repo: harbor.adamkoro.com/swagger-ui/swagger-ui
    registry: harbor.adamkoro.com
  volumes:
    - name: kaniko-auth
      path: /kaniko/.docker

volumes:
- name: kaniko-auth
  temp: {}